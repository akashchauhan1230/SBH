{% extends 'homebase.html' %}

{% block main %}
<div class="row">
    <div class="col-sm-12">
        <h3>Application For {{project.projectname}}</h3>
    </div>
    <table class="table">
        <tr>
            <th>S.NO</th>
            <th>Contractor Name</th>
            <th>Design</th>
            <th>Estimated Budget</th>
            <th>Estimated Duration</th>
            <th>Status</th>
            <th>Submitted At</th>
            <th>Action</th>
        </tr>
        {% for a in applications %}
        <tr>
            <td>{{forloop.counter}}</td>
            <td>{{a.contractor.name}}({{a.contractor.contactno}})</td>
            <td>
                {% if a.design_file %}
                <a href="{{a.design_file.url}}" target="_blank" class="btn btn-primary">View Design</a>
                {% else %}
                No Design Files
                {% endif %}
            </td>
            <td>{{a.estimated_budget}}</td>
            <td>{{a.estimated_duration}}</td>
            <td>
                {% if a.status == 'pending' %}
                <span class="btn btn-warning">pending</span>
                {% elif a.status == 'approved' %}
                <span class="btn btn-success">approved</span>
                {% elif a.status == 'rejected' %}
                <span class="btn btn-danger">Rejected</span>
                {% else %}
                {{a.status}}
                {% endif %}

            </td>
            <td>{{a.submitted_at}}</td>
            <td>
                {% if project.contractor %}

                    Assigned to {{ project.contractor.name }}

                {% elif a.status == 'rejected' %}

                <span class="btn btn-danger">Rejected</span>
                {% elif a.status == 'approved' %}
                <span class="btn btn-success">Approved</span>
                
                

                {% else %}
                <span><a href="{% url 'approveapp' id=a.id %}" class="btn btn-success">Approve</a></span>
                <span><a href="{% url 'rejectapp' id=a.id %}" class="btn btn-danger">Reject</a></span>
                {%  endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}